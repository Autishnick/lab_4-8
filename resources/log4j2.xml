<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN" monitorInterval="30">
    <Properties>
        <Property name="LOG_PATTERN">%d{yyyy-MM-dd HH:mm:ss} [%t] %-5level %logger{36} - %msg%n</Property>
        <Property name="LOG_FILE_PATH">logs/application.log</Property>
    </Properties>

    <Appenders>
        <!-- ÐšÐ¾Ð½ÑÐ¾Ð»ÑŒÐ½Ñ– Ð°Ð¿ÐµÐ½Ð´ÐµÑ€Ð¸ Ð²Ð¸Ð¼ÐºÐ½ÐµÐ½Ð¾ - Ð»Ð¾Ð³Ð¸ Ñ‚Ñ–Ð»ÑŒÐºÐ¸ Ð² Ñ„Ð°Ð¹Ð» -->
        <!-- Ð¯ÐºÑ‰Ð¾ Ð¿Ð¾Ñ‚Ñ€Ñ–Ð±Ð½Ð¾ ÑƒÐ²Ñ–Ð¼ÐºÐ½ÑƒÑ‚Ð¸ ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ, Ñ€Ð¾Ð·ÐºÐ¾Ð¼ÐµÐ½Ñ‚ÑƒÐ¹Ñ‚Ðµ:
        <Console name="ConsoleInfo" target="SYSTEM_OUT">
            <PatternLayout pattern="${LOG_PATTERN}"/>
            <ThresholdFilter level="INFO" onMatch="ACCEPT" onMismatch="DENY"/>
        </Console>

        <Console name="ConsoleError" target="SYSTEM_ERR">
            <PatternLayout pattern="${LOG_PATTERN}"/>
            <ThresholdFilter level="WARN" onMatch="ACCEPT" onMismatch="DENY"/>
        </Console>
        -->

        <RollingFile name="FileAppender" fileName="${LOG_FILE_PATH}"
                     filePattern="logs/application-%d{yyyy-MM-dd}-%i.log.gz">
            <PatternLayout pattern="${LOG_PATTERN}"/>
            <Policies>
                <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
                <SizeBasedTriggeringPolicy size="10MB"/>
            </Policies>
            <DefaultRolloverStrategy max="10"/>
        </RollingFile>

        <SMTP name="EmailAppender"
              subject="ðŸš¨ ÐšÐ Ð˜Ð¢Ð˜Ð§ÐÐ ÐŸÐžÐœÐ˜Ð›ÐšÐ Ð² Music System - ${date:dd.MM.yyyy HH:mm:ss}"
              to="${sys:log.email.to}"
              from="${sys:log.email.from}"
              smtpHost="${sys:log.email.smtp.host}"
              smtpPort="${sys:log.email.smtp.port}"
              smtpUsername="${sys:log.email.smtp.user}"
              smtpPassword="${sys:log.email.smtp.password}"
              smtpProtocol="smtp"
              smtpDebug="false"
              bufferSize="512"
              ignoreExceptions="true">
            <PatternLayout>
                <Pattern>%d{yyyy-MM-dd HH:mm:ss} [%t] %-5level %logger{36} - %msg%n%ex{full}</Pattern>
            </PatternLayout>
            <ThresholdFilter level="FATAL" onMatch="ACCEPT" onMismatch="DENY"/>
            <BurstFilter level="FATAL" rate="1" maxBurst="1"/>
        </SMTP>
    </Appenders>

    <Loggers>
        <Logger name="com.musicsystem" level="${sys:log.level:-INFO}" additivity="false">
            <!-- ÐšÐ¾Ð½ÑÐ¾Ð»ÑŒÐ½Ñ– Ð°Ð¿ÐµÐ½Ð´ÐµÑ€Ð¸ Ð²Ð¸Ð¼ÐºÐ½ÐµÐ½Ð¾ -->
            <AppenderRef ref="FileAppender"/>
            <AppenderRef ref="EmailAppender"/>
        </Logger>

        <Root level="${sys:log.level:-INFO}">
            <!-- ÐšÐ¾Ð½ÑÐ¾Ð»ÑŒÐ½Ñ– Ð°Ð¿ÐµÐ½Ð´ÐµÑ€Ð¸ Ð²Ð¸Ð¼ÐºÐ½ÐµÐ½Ð¾ -->
            <AppenderRef ref="FileAppender"/>
            <AppenderRef ref="EmailAppender"/>
        </Root>
    </Loggers>
</Configuration>

